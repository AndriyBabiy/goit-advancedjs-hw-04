{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst form = document.querySelector('.search-form');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more');\nlet page = 1;\nlet totalImages = 0;\nlet totalPages = 0;\nlet query = '';\n\nloadMoreButton.hidden = true;\n\nform.addEventListener('submit', handlerImageSearch);\nloadMoreButton.addEventListener('click', handlerLoadMore);\n\nasync function handlerImageSearch(evt) {\n  evt.preventDefault();\n  gallery.innerHTML = '';\n  loadMoreButton.hidden = true;\n  gallery.classList.remove('grid-styling');\n\n  page = 1;\n  totalPages = 0;\n  totalImages = 0;\n  query = evt.currentTarget.elements.searchQuery.value;\n\n  try {\n    populateImages(query);\n  } catch (err) {\n    console.error(err);\n  } finally {\n    form.reset();\n  }\n}\n\nasync function handlerLoadMore() {\n  loadMoreButton.hidden = true;\n\n  page += 1;\n\n  console.log(page);\n\n  try {\n    await populateImages(query, page);\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nasync function populateImages(query, page = 1) {\n  const data = await fetchImages(query, page);\n\n  totalImages = data.totalHits;\n  totalPages = Math.ceil(data.totalHits / 40);\n\n  const images = data.hits;\n\n  if (images.length === 0) {\n    iziToastErrorPopup(\n      'Sorry, there are no images matching your search query. Please try again.'\n    );\n  } else {\n    if (page === 1) {\n      iziToastSuccessPopup(`Hooray! We found ${data.totalHits} images.`);\n    }\n\n    gallery.classList.add('grid-styling');\n\n    if (page < totalPages) {\n      loadMoreButton.disabled = false;\n      loadMoreButton.removeAttribute('style');\n      loadMoreButton.textContent = 'Load more';\n      loadMoreButton.hidden = false;\n    } else {\n      loadMoreButton.hidden = true;\n      if (page !== 1) {\n        loadMoreButton.hidden = false;\n        loadMoreButton.disabled = true;\n        loadMoreButton.setAttribute(\n          'style',\n          `\n            background: none;\n            color: inherit;\n            border: none;\n            padding: 0;\n            font: inherit;\n            cursor: default;\n            outline: inherit;\n        `\n        );\n        loadMoreButton.textContent =\n          \"We're sorry, but you've reached the end of search results.\";\n      }\n    }\n\n    gallery.insertAdjacentHTML('beforeend', createImageBlockMarkup(images));\n  }\n}\n\nasync function fetchImages(query, page) {\n  const CORE_URL = 'https://pixabay.com/api/';\n  const API_KEY = '42185018-8d9cd3aefdae43a32ddab8929';\n\n  const params = new URLSearchParams({\n    key: API_KEY,\n    per_page: 40,\n    page: page,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n  });\n\n  const response = await fetch(`${CORE_URL}?${params}`);\n\n  if (!response.ok) {\n    throw new Error(response.statusText);\n  }\n\n  return await response.json();\n}\n\nfunction createImageBlockMarkup(arr) {\n  return arr\n    .map(\n      ({ webformatURL, tags, likes, views, comments, downloads }) => `\n      <div class=\"photo-card\">\n        <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        <div class=\"info\">\n            <p class=\"info-item\">\n              <b>Likes</b>\n              ${likes}\n            </p>\n            <p class=\"info-item\">\n            <b>Views</b>\n            ${views}\n          </p>\n            <p class=\"info-item\">\n              <b>Comments</b>\n              ${comments}\n            </p>\n            <p class=\"info-item\">\n              <b>Downloads</b>\n              ${downloads}\n            </p>\n        </div>\n      </div>\n    `\n    )\n    .join('');\n}\n\nfunction iziToastSuccessPopup(text) {\n  return iziToast.show({\n    message: `${text}`,\n    color: 'green',\n    position: 'topRight',\n    timeout: 3000,\n  });\n}\n\nfunction iziToastErrorPopup(text) {\n  gallery.insertAdjacentHTML(\n    'afterbegin',\n    `<div class='iziToastLocation' style='width: 60%'></div>`\n  );\n\n  return iziToast.show({\n    message: `${text}`,\n    color: 'grey',\n    target: '.iziToastLocation',\n    timeout: false,\n  });\n}\n"],"names":["form","gallery","loadMoreButton","page","totalPages","query","handlerImageSearch","handlerLoadMore","evt","populateImages","err","e","data","fetchImages","images","iziToastErrorPopup","iziToastSuccessPopup","createImageBlockMarkup","CORE_URL","API_KEY","params","response","arr","webformatURL","tags","likes","views","comments","downloads","text","iziToast"],"mappings":"svBAIA,MAAMA,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAiB,SAAS,cAAc,YAAY,EAC1D,IAAIC,EAAO,EAEPC,EAAa,EACbC,EAAQ,GAEZH,EAAe,OAAS,GAExBF,EAAK,iBAAiB,SAAUM,CAAkB,EAClDJ,EAAe,iBAAiB,QAASK,CAAe,EAExD,eAAeD,EAAmBE,EAAK,CACrCA,EAAI,eAAc,EAClBP,EAAQ,UAAY,GACpBC,EAAe,OAAS,GACxBD,EAAQ,UAAU,OAAO,cAAc,EAEvCE,EAAO,EACPC,EAAa,EAEbC,EAAQG,EAAI,cAAc,SAAS,YAAY,MAE/C,GAAI,CACFC,EAAeJ,CAAK,CACrB,OAAQK,EAAP,CACA,QAAQ,MAAMA,CAAG,CACrB,QAAY,CACRV,EAAK,MAAK,CACX,CACH,CAEA,eAAeO,GAAkB,CAC/BL,EAAe,OAAS,GAExBC,GAAQ,EAER,QAAQ,IAAIA,CAAI,EAEhB,GAAI,CACF,MAAMM,EAAeJ,EAAOF,CAAI,CACjC,OAAQQ,EAAP,CACA,QAAQ,MAAMA,CAAC,CAChB,CACH,CAEA,eAAeF,EAAeJ,EAAOF,EAAO,EAAG,CAC7C,MAAMS,EAAO,MAAMC,EAAYR,EAAOF,CAAI,EAE5BS,EAAK,UACnBR,EAAa,KAAK,KAAKQ,EAAK,UAAY,EAAE,EAE1C,MAAME,EAASF,EAAK,KAEhBE,EAAO,SAAW,EACpBC,EACE,0EACN,GAEQZ,IAAS,GACXa,EAAqB,oBAAoBJ,EAAK,mBAAmB,EAGnEX,EAAQ,UAAU,IAAI,cAAc,EAEhCE,EAAOC,GACTF,EAAe,SAAW,GAC1BA,EAAe,gBAAgB,OAAO,EACtCA,EAAe,YAAc,YAC7BA,EAAe,OAAS,KAExBA,EAAe,OAAS,GACpBC,IAAS,IACXD,EAAe,OAAS,GACxBA,EAAe,SAAW,GAC1BA,EAAe,aACb,QACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SASV,EACQA,EAAe,YACb,+DAIND,EAAQ,mBAAmB,YAAagB,EAAuBH,CAAM,CAAC,EAE1E,CAEA,eAAeD,EAAYR,EAAOF,EAAM,CACtC,MAAMe,EAAW,2BACXC,EAAU,qCAEVC,EAAS,IAAI,gBAAgB,CACjC,IAAKD,EACL,SAAU,GACV,KAAMhB,EACN,EAAGE,EACH,WAAY,QACZ,YAAa,aACb,WAAY,MAChB,CAAG,EAEKgB,EAAW,MAAM,MAAM,GAAGH,KAAYE,GAAQ,EAEpD,GAAI,CAACC,EAAS,GACZ,MAAM,IAAI,MAAMA,EAAS,UAAU,EAGrC,OAAO,MAAMA,EAAS,MACxB,CAEA,SAASJ,EAAuBK,EAAK,CACnC,OAAOA,EACJ,IACC,CAAC,CAAE,aAAAC,EAAc,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAS,IAAO;AAAA;AAAA,oBAEjDL,WAAsBC;AAAA;AAAA;AAAA;AAAA,gBAI1BC;AAAA;AAAA;AAAA;AAAA,cAIFC;AAAA;AAAA;AAAA;AAAA,gBAIEC;AAAA;AAAA;AAAA;AAAA,gBAIAC;AAAA;AAAA;AAAA;AAAA,KAKX,EACA,KAAK,EAAE,CACZ,CAEA,SAASZ,EAAqBa,EAAM,CAClC,OAAOC,EAAS,KAAK,CACnB,QAAS,GAAGD,IACZ,MAAO,QACP,SAAU,WACV,QAAS,GACb,CAAG,CACH,CAEA,SAASd,EAAmBc,EAAM,CAChC,OAAA5B,EAAQ,mBACN,aACA,yDACJ,EAES6B,EAAS,KAAK,CACnB,QAAS,GAAGD,IACZ,MAAO,OACP,OAAQ,oBACR,QAAS,EACb,CAAG,CACH"}